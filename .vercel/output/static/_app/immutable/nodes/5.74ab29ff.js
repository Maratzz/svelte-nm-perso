import{S as pe,i as be,s as ve,k as s,q,a as D,l as u,m as _,r as W,h as b,c as I,n as i,b as he,C as e,O as de,D as ce,P as _e,w as Ee}from"../chunks/index.65028fb2.js";import{p as ye}from"../chunks/parse.d12b0d5b.js";import{j as Ne}from"../chunks/singletons.ec0928d8.js";import{a as ge}from"../chunks/navigation.90715cf9.js";const we=Ne("apply_action");function Le(l){const r=JSON.parse(l);return r.data&&(r.data=ye(r.data)),r}function fe(l,r=()=>{}){const a=async({action:o,result:p,reset:y})=>{p.type==="success"&&(y!==!1&&HTMLFormElement.prototype.reset.call(l),await ge()),(location.origin+location.pathname===o.origin+o.pathname||p.type==="redirect"||p.type==="error")&&we(p)};async function v(o){var h,g,T;o.preventDefault();const p=new URL((h=o.submitter)!=null&&h.hasAttribute("formaction")?o.submitter.formAction:HTMLFormElement.prototype.cloneNode.call(l).action),y=new FormData(l),n=(g=o.submitter)==null?void 0:g.getAttribute("name");n&&y.append(n,((T=o.submitter)==null?void 0:T.getAttribute("value"))??"");const N=new AbortController;let d=!1;const M=await r({action:p,cancel:()=>d=!0,controller:N,data:y,form:l,submitter:o.submitter})??a;if(d)return;let E;try{const t=await fetch(p,{method:"POST",headers:{accept:"application/json","x-sveltekit-action":"true"},cache:"no-store",body:y,signal:N.signal});E=Le(await t.text()),E.type==="error"&&(E.status=t.status)}catch(t){if((t==null?void 0:t.name)==="AbortError")return;E={type:"error",error:t}}M({action:p,data:y,form:l,update:t=>a({action:p,result:E,reset:t==null?void 0:t.reset}),result:E})}return HTMLFormElement.prototype.addEventListener.call(l,"submit",v),{destroy(){HTMLFormElement.prototype.removeEventListener.call(l,"submit",v)}}}function Ae(l){let r,a,v,o,p,y,n,N,d,w,M,E,h,g,T,t,k,Q,X,L,B,Y,O,S,Z,x,A,C,$,j,P,z,ee,F,H,U,te,ae,le;return{c(){r=s("div"),a=s("form"),v=s("div"),o=s("label"),p=q("Email"),y=D(),n=s("input"),N=D(),d=s("div"),w=s("label"),M=q("Nom complet"),E=D(),h=s("input"),T=D(),t=s("div"),k=s("label"),Q=q("Pseudo"),X=D(),L=s("input"),Y=D(),O=s("div"),S=s("label"),Z=q("Website"),x=D(),A=s("input"),$=D(),j=s("div"),P=s("input"),ee=D(),F=s("form"),H=s("div"),U=s("button"),te=q("Déconnexion"),this.h()},l(m){r=u(m,"DIV",{});var c=_(r);a=u(c,"FORM",{method:!0,action:!0});var f=_(a);v=u(f,"DIV",{});var V=_(v);o=u(V,"LABEL",{for:!0});var R=_(o);p=W(R,"Email"),R.forEach(b),y=I(V),n=u(V,"INPUT",{id:!0,type:!0}),V.forEach(b),N=I(f),d=u(f,"DIV",{});var J=_(d);w=u(J,"LABEL",{for:!0});var ne=_(w);M=W(ne,"Nom complet"),ne.forEach(b),E=I(J),h=u(J,"INPUT",{id:!0,name:!0,type:!0}),J.forEach(b),T=I(f),t=u(f,"DIV",{});var G=_(t);k=u(G,"LABEL",{for:!0});var re=_(k);Q=W(re,"Pseudo"),re.forEach(b),X=I(G),L=u(G,"INPUT",{id:!0,name:!0,type:!0}),G.forEach(b),Y=I(f),O=u(f,"DIV",{});var K=_(O);S=u(K,"LABEL",{for:!0});var ie=_(S);Z=W(ie,"Website"),ie.forEach(b),x=I(K),A=u(K,"INPUT",{id:!0,name:!0,type:!0}),K.forEach(b),$=I(f),j=u(f,"DIV",{});var oe=_(j);P=u(oe,"INPUT",{type:!0}),oe.forEach(b),f.forEach(b),ee=I(c),F=u(c,"FORM",{method:!0,action:!0});var se=_(F);H=u(se,"DIV",{});var ue=_(H);U=u(ue,"BUTTON",{});var me=_(U);te=W(me,"Déconnexion"),me.forEach(b),ue.forEach(b),se.forEach(b),c.forEach(b),this.h()},h(){var m,c,f;i(o,"for","email"),i(n,"id","email"),i(n,"type","text"),n.value=l[3].user.email,n.disabled=!0,i(w,"for","fullName"),i(h,"id","fullName"),i(h,"name","fullName"),i(h,"type","text"),h.value=g=((m=l[0])==null?void 0:m.fullName)??l[4],i(k,"for","username"),i(L,"id","username"),i(L,"name","username"),i(L,"type","text"),L.value=B=((c=l[0])==null?void 0:c.username)??l[5],i(S,"for","website"),i(A,"id","website"),i(A,"name","website"),i(A,"type","url"),A.value=C=((f=l[0])==null?void 0:f.website)??l[6],i(P,"type","submit"),P.value=z=l[2]?"Chargement...":"Mettre à jour",P.disabled=l[2],i(a,"method","post"),i(a,"action","?/update"),U.disabled=l[2],i(F,"method","post"),i(F,"action","?/signout")},m(m,c){he(m,r,c),e(r,a),e(a,v),e(v,o),e(o,p),e(v,y),e(v,n),e(a,N),e(a,d),e(d,w),e(w,M),e(d,E),e(d,h),e(a,T),e(a,t),e(t,k),e(k,Q),e(t,X),e(t,L),e(a,Y),e(a,O),e(O,S),e(S,Z),e(O,x),e(O,A),e(a,$),e(a,j),e(j,P),l[10](a),e(r,ee),e(r,F),e(F,H),e(H,U),e(U,te),ae||(le=[de(fe.call(null,a,l[7])),de(fe.call(null,F,l[8]))],ae=!0)},p(m,[c]){var f,V,R;c&1&&g!==(g=((f=m[0])==null?void 0:f.fullName)??m[4])&&h.value!==g&&(h.value=g),c&1&&B!==(B=((V=m[0])==null?void 0:V.username)??m[5])&&L.value!==B&&(L.value=B),c&1&&C!==(C=((R=m[0])==null?void 0:R.website)??m[6])&&A.value!==C&&(A.value=C),c&4&&z!==(z=m[2]?"Chargement...":"Mettre à jour")&&(P.value=z),c&4&&(P.disabled=m[2]),c&4&&(U.disabled=m[2])},i:ce,o:ce,d(m){m&&b(r),l[10](null),ae=!1,_e(le)}}}function De(l,r,a){let{data:v}=r,{form:o}=r,{session:p,supabase:y,profile:n}=v,N,d=!1,w=(n==null?void 0:n.full_name)??"",M=(n==null?void 0:n.username)??"",E=(n==null?void 0:n.website)??"";n==null||n.avatar_url;function h(){return a(2,d=!0),async()=>{a(2,d=!1)}}function g(){return a(2,d=!0),async({update:t})=>{a(2,d=!1),t()}}function T(t){Ee[t?"unshift":"push"](()=>{N=t,a(1,N)})}return l.$$set=t=>{"data"in t&&a(9,v=t.data),"form"in t&&a(0,o=t.form)},[o,N,d,p,w,M,E,h,g,v,T]}class Me extends pe{constructor(r){super(),be(this,r,De,Ae,ve,{data:9,form:0})}}export{Me as component};
